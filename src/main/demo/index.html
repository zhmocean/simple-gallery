<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
    <script type="text/javascript" src="jquery-1.11.1.min.js"></script>
    <style type="text/css">
        .foot {
            position: fixed;
            _position: absolute;
            bottom: 0px;
            _bottom: 0px;
            _margin-top: expression(this.style.pixelHeight + document.documentElement.scrollTop)
        }

        .exif-raw {
            margin: 0px;
            padding: 0px;
            position: relative;
            font-family: helvetica;
            font-size: 10px;
            line-height: 1.2em;
            color: white;
            clear: both;
            margin-top: 5px;
        }

        .exif-row-title{
            float: left;
            width: 100px;

        }

        .exif-row-desc{
            right: 0;
        }
    </style>
    <script type="text/javascript">
        var isH = false;
        var gallery = [
            {"src":"http://photo.tangcu.biz/wp-content/gallery/tulip/IMG_5065.jpg", "desc":"", "exif":{"Manufacturer":"Canon","Model Name":"Canon EOS 50D","Date":"2009:04:05 11:37:09","Exposure Time":"1\/250","F Number":5.6,"ISO":100,"Focal Length":"40mm","ExposureBiasValue":"0 EV","File Name":"IMG_0842.JPG","File Size":100597,"Software":"Picasa 3.0","X Resolution":"350\/1","Y Resolution":"350\/1","Exif Version":"2.21"}},
            {"src":"http://photo.tangcu.biz/wp-content/gallery/night/IMG_3568.jpg", "desc":"", "exif":{}},
            {"src":"http://photo.tangcu.biz/wp-content/gallery/night/IMG_0666.jpg", "desc":"", "exif":{}},
            {"src":"http://photo.tangcu.biz/wp-content/gallery/reed/IMG_1670.jpg", "desc":"", "exif":{}}
        ];
        var nowImg = 0;

        $(document).ready(function () {

                    toH();
                }
        )

        function stopAll() {
            $("div").stop();

        }

        function toH() {
            if (isH) {
                return;
            }
            stopAll();
            hideV(function () {
                showH();
            });
            //showH();
            isH = true;
        }

        function toV() {
            if (!isH) {
                return;
            }

            stopAll();

            hideH(function () {
                showV();
            });

            //showV();
            isH = false;
        }

        function showH() {
            var top = $("div#top");
            top.animate({height: 'show'});
            var top = $("div#bottom");
            top.animate({height: 'show'});

        }
        function showV() {
            var left = $("div#left");
            left.animate({width: 'show'});
            var right = $("div#right");
            right.animate({width: 'show'});

        }
        function hideH(callback) {
            var top = $("div#top");
            top.animate({height: 'hide'}, 'normal', null, callback);
            var top = $("div#bottom");
            top.animate({height: 'hide'});

        }
        function hideV(callback) {
            var left = $("div#left");
            left.animate({width: 'hide'}, 'normal', null, callback);
            var right = $("div#right");
            right.animate({width: 'hide'});

        }


        function exBar() {
            if (isH) {
                toV();
            } else {
                toH();
            }

            showImage('imgv.jpg');
        }
        function showImage(img, direction) {
            var imgPanel = $("div#imgcur");

            var preload = $("#preload");
            preload.attr("src", img["src"]);

            var loading = $("#loading");
            loading.show();

            document.getElementById("preload").onload = function () {

                imgPanel.hide();
                imgPanel.css({"background-image": "url('" + img["src"] + "')"});

                displayExif(img["exif"]);

                if (direction == "r") {
                    imgPanel.css({"left": "-40px"});
                    //imgPanel.animate({opacity: 'hidden', left: '-40px'}, 'fast', null, null);
                } else {
                    imgPanel.css({"left": "40px"});
                    //imgPanel.animate({opacity: 'hidden', left: '40px'}, 'fast', null, null);
                }
                imgPanel.animate({opacity: 'show', left: '0px'}, 'slow', null, null);
                loading.hide();
            }

        }

        function displayExif(exif) {
            var exifSwitch = ["Model Name", "Exposure Time", "F Number", "ISO", "Focal Length",
                "Focal Length In35mmFilm", "Light Source"];

            if (exif) {
                $("#exif_panel").empty();
                for (var i in exifSwitch) {
                    var key = exifSwitch[i];
                    if (exif[key]) {
                        $('<div class="exif-raw"><div class="exif-row-title">'+key+'</div><div class="exif-row-desc">'+exif[key]+'</div></div>').appendTo($("#exif_panel"))
                    }
                }
            }
        }

        function toPreImage() {
            if (nowImg > 0) {
                nowImg--;
            } else {
                nowImg = gallery.length - 1;
            }

            showImage(gallery[nowImg], "l");
        }

        function toNextImage() {
            if (nowImg < gallery.length - 1) {
                nowImg++;
            } else {
                nowImg = 0;
            }

            showImage("gallery/" + gallery[nowImg], "r");
        }

    </script>
</head>
<body style="background: #555555; margin: 0px; overflow-x: hidden;">
<div onclick="exBar()" id="imgcur" name="imgcur"
     style="width: 100%; height: 100%; margin: 0px;background-image: url('img.jpg');background-repeat: no-repeat;background-size: cover;background-position-x: 50%; background-position-y: 50%;position: absolute;">

</div>
<div id="top" name="top"
     style="z-index:999;width:100%;top:0;position: absolute;opacity: 0.6; background: #111111; margin: 0px; height: 40px;color: #BBBBBB;display: none;">
    <div id="top-logo" style="background: url('images/logo_white.png') no-repeat left 0;width: 190px;margin:10px;height: 20px;opacity: 0.7;float: left;"></div>
    <div id="menu" style="width: 600px; float: right;">

        3.3转角处的偶遇
    </div>
</div>
<div id="bottom" name="bottom" class="foot"
     style="z-index:999;width:100%;bottom:0;position: absolute;opacity: 0.5; background: #111111; margin: 0px; height: 100px;color: #FFFFFF;width: 100%;display: none;">
<div id="exif_panel" style="width: 300px; float: right;height: 100%;"></div>
</div>
<div id="left" name="left" class="left"
     style="opacity: 0.6; background: #111111; margin: 0px; width: 140px;color: #BBBBBB;height: 100%;float:left;left:0;top:0;position:absolute;display: none;">
    sdfads
</div>
<div id="right" name="right" class="right"
     style="opacity: 0.4; background: #111111; margin: 0px; width: 160px;color: #FFFFFF;height: 100%;right:0;top:0;position:absolute;display: none;">


</div>
<div id="pre-button"
     style="width: 300px;height: 100%;top:0;position: absolute;z-index:99;left:0;opacity: 0.1; cursor: pointer; "
     onclick="return toPreImage();"></div>
<div id="next-button"
     style="width: 300px;height: 100%;top:0;position: absolute;z-index:99;right:0;opacity: 0.1; cursor: pointer; "
     onclick="return toNextImage();"></div>
<img src="" id="preload" style="display: none;">

<div style="width: 200px;margin:0 auto 0;">


    <div id="loading"
         style="z-index:99;position:absolute;display: none;opacity: 0.2;width: 200px;height:200px; margin-top: 300px; background: url('images/loading.gif') no-repeat center 0;"></div>
</div>
</body>
</html>
